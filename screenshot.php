<?
function screenshot($url)
{
	//Check to see if file exist in local directory
	$localFile = "sites/".$url.".png";
	if (file_exists($localFile))
	{
		return $localFile;
	}
	else
	{
		//create array of data to be posted
		$post_data['url'] = $url;
		//$post_data['url'] = 'google.com';

		//traverse array and prepare data for posting (key1=value1)
		foreach ( $post_data as $key => $value) {
		    $post_items[] = $key . '=' . $value;
		}
		//create the final string to be posted using implode()
		$post_string = implode ('&', $post_items);

		//create cURL connection
		$curl_connection =
		  curl_init('http://url2png.com/example_proxy/');
		//set options
		curl_setopt($curl_connection, CURLOPT_CONNECTTIMEOUT, 30);
		curl_setopt($curl_connection, CURLOPT_USERAGENT,"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
		curl_setopt($curl_connection, CURLOPT_RETURNTRANSFER, true);
		curl_setopt($curl_connection, CURLOPT_SSL_VERIFYPEER, false);
		curl_setopt($curl_connection, CURLOPT_FOLLOWLOCATION, 1);
		//set data to be posted
		curl_setopt($curl_connection, CURLOPT_POSTFIELDS, $post_string);
		//perform our request
		$result = curl_exec($curl_connection);
		//echo "result:".$result."\n";


		curl_close($curl_connection);
		$current = file_get_contents($result);
		file_put_contents("sites/".$url.".png", $current);
		return $result;
	}
}
?>
